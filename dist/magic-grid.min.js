!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).MagicGrid=t()}(this,(function(){"use strict";function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function _assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}function _callSuper(e,t,n){return t=_getPrototypeOf(t),function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,_isNativeReflectConstruct()?Reflect.construct(t,[],_getPrototypeOf(e).constructor):t.apply(e,n))}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classPrivateFieldInitSpec(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function _classPrivateFieldSet2(e,t,n){return e.set(_assertClassBrand(e,t),n),n}function _createClass(e,t,n){return t&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_toPropertyKey(r.key),r)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _createForOfIteratorHelper(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}(e))||t){n&&(e=n);var r=0,F=function(){};return{s:F,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function _defineProperty(e,t,n){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _getPrototypeOf(e){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},_getPrototypeOf(e)}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _setPrototypeOf(e,t){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},_setPrototypeOf(e,t)}function _toPropertyKey(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==typeof t?t:t+""}var e=_createClass((function Listener(e,t,n){_classCallCheck(this,Listener),
/*
     Listener class holds the event,
     handler and a unique id
     */
_defineProperty(this,"id",void 0),_defineProperty(this,"event",void 0),_defineProperty(this,"handler",void 0),this.id=e,this.event=t,this.handler=n})),t=new WeakMap,error=function(e){throw new Error("Missing property '".concat(e,"' in MagicGrid config"))},n="positionComplete";
return function(e){
/**
     * Initializes the necessary variables
     * for a magic grid.
     *
     * @param config - configuration object
     */
function MagicGrid(e){var t;return _classCallCheck(this,MagicGrid),t=_callSuper(this,MagicGrid),function(e){if(!e)throw new Error("No config object has been provided.");for(var t=0,n=["useTransform","center"];t<n.length;t++){var r=n[t];"boolean"!=typeof e[r]&&(e[r]=!0)}"number"!=typeof e.gutter&&(e.gutter=25),e.container||error("container"),e.items||e.static||error("items or static")}(e),e.container instanceof HTMLElement?(t.container=e.container,t.containerClass=e.container.className):(t.containerClass=e.container,t.container=document.querySelector(e.container)),t.static=e.static||!1,t.size=e.items,t.gutter=e.gutter,t.maxColumns=e.maxColumns||!1,t.useMin=e.useMin||!1,t.useTransform=e.useTransform,t.animate=e.animate||!1,t.center=e.center,t.styledItems=new Set,t.resizeObserver=null,t.isPositioning=!1,t}
/**
     * Initializes styles
     *
     * @private
     */return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}(MagicGrid,e),_createClass(MagicGrid,[{key:"initStyles",value:function(){if(this.ready()){this.container.style.position="relative";for(var e=this.items(),t=0;t<e.length;t++)if(!this.styledItems.has(e[t])){var n=e[t].style;n.position="absolute",this.animate&&(n.transition="".concat(this.useTransform?"transform":"top, left"," 0.2s ease")),this.styledItems.add(e[t])}}}
/**
       * Gets a collection of all items in a grid.
       *
       * @return {HTMLCollection}
       * @private
       */},{key:"items",value:function(){return this.container.children}
/**
       * Calculates the width of a column.
       *
       * @return width of a column in the grid
       * @private
       */},{key:"colWidth",value:function(){return this.items()[0].getBoundingClientRect().width+this.gutter}
/**
       * Initializes an array of empty columns
       * and calculates the leftover whitespace.
       *
       * @return {{cols: Array, wSpace: number}}
       * @private
       */},{key:"setup",value:function(){var e=this.container.getBoundingClientRect().width,t=this.colWidth(),n=Math.floor(e/t)||1,r=[];this.maxColumns&&n>this.maxColumns&&(n=this.maxColumns);for(var i=0;i<n;i++)r[i]={height:0,index:i};return{cols:r,wSpace:e-n*t+this.gutter}}
/**
       * Gets the next available column.
       *
       * @param cols list of columns
       * @param i index of dom element
       *
       * @return {*} next available column
       * @private
       */},{key:"nextCol",value:function(e,t){return this.useMin?function(e){var t,n=e[0],r=_createForOfIteratorHelper(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;i.height<n.height&&(n=i)}}catch(e){r.e(e)}finally{r.f()}return n}(e):e[t%e.length]}
/**
       * Positions each item in the grid, based
       * on their corresponding column's height
       * and index then stretches the container to
       * the height of the grid.
       */},{key:"positionItems",value:function(){if(!this.isPositioning){this.isPositioning=!0;var e=this.setup(),t=e.cols,r=e.wSpace,i=0,o=this.colWidth(),s=this.items();r=this.center?Math.floor(r/2):0,this.initStyles();for(var a=0;a<s.length;a++){var c=this.nextCol(t,a),u=s[a],l=c.height?this.gutter:0,f=c.index*o+r+"px",h=c.height+l+"px";this.useTransform?u.style.transform="translate(".concat(f,", ").concat(h,")"):(u.style.top=h,u.style.left=f),c.height+=u.getBoundingClientRect().height+l,c.height>i&&(i=c.height)}this.container.style.height=i+this.gutter+"px",this.isPositioning=!1,this.emit(n)}}
/**
       * Checks if every item has been loaded
       * in the dom.
       *
       * @return {Boolean} true if every item is present
       */},{key:"ready",value:function(){return!!this.static||this.items().length>=this.size}
/**
       * Periodically checks that all items
       * have been loaded in the dom. Calls
       * this.listen() once all the items are
       * present.
       *
       * @private
       */},{key:"getReady",value:function(){var e=this,t=setInterval((function(){e.container=document.querySelector(e.containerClass),e.ready()&&(clearInterval(t),e.listen())}),100)}},{key:"observeContainerResize",value:function(){var e=this;this.resizeObserver||(this.resizeObserver=new ResizeObserver((function(){setTimeout((function(){e.positionItems()}),200)})),this.resizeObserver.observe(this.container))}
/**
       * Positions all the items and
       * repositions them whenever the
       * window size changes.
       */},{key:"listen",value:function(){var e=this;this.ready()?(window.addEventListener("resize",(function(){setTimeout((function(){e.positionItems()}),200)})),this.observeContainerResize(),this.positionItems()):this.getReady()}},{key:"onPositionComplete",value:function(e){return this.addListener(n,e)}}])}(function(){return _createClass((function EventEmitter(){_classCallCheck(this,EventEmitter),
/*
          array of emitter
          emitter: takes in an event and handler
          handler: is the function it calls
      */
_defineProperty(this,"listeners",void 0),_classPrivateFieldInitSpec(this,t,void 0),this.listeners=[],_classPrivateFieldSet2(t,this,0)}),[{key:"removeListener",value:function(e){var t=this.listeners.findIndex((function(t){return t.id===e}));return-1!==t&&(this.listeners.splice(t,1),!0)}},{key:"addListener",value:function(n,r){var i,o,s,a,c=(_classPrivateFieldSet2(t,this,(a=this,i=(s=t).get(_assertClassBrand(s,a)),o=i++,i)),o);return this.listeners.push(new e(c,n,r)),c}},{key:"emit",value:function(e,t){var n,r=_createForOfIteratorHelper(this.listeners);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.event===e&&i.handler(t)}}catch(e){r.e(e)}finally{r.f()}}}])}())}));
//# sourceMappingURL=magic-grid.min.js.map
